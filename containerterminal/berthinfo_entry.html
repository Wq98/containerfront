<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<!--[if lt IE 9]>
<script type="text/javascript" src="js/html5.js"></script>
<script type="text/javascript" src="js/respond.min.js"></script>
<script type="text/javascript" src="js/PIE_IE678.js"></script>
<![endif]-->
<link href="assets/css/bootstrap.min.css" rel="stylesheet" />
<link rel="stylesheet" href="css/style.css"/>       
<link href="assets/css/codemirror.css" rel="stylesheet">
<link rel="stylesheet" href="assets/css/ace.min.css" />
      <link rel="stylesheet" href="Widget/zTree/css/zTreeStyle/zTreeStyle.css" type="text/css">
<link rel="stylesheet" href="assets/css/font-awesome.min.css" />
<!--[if IE 7]>
		  <link rel="stylesheet" href="assets/css/font-awesome-ie7.min.css" />
		<![endif]-->
<link href="Widget/icheck/icheck.css" rel="stylesheet" type="text/css" />
<link href="Widget/webuploader/0.1.5/webuploader.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="scripts/artDialog/artDialog.js?skin=default"></script>
<title>泊位信息录入</title>
</head>
<body>
<div class="clearfix" id="add_picture">
<div id="scrollsidebar" class="left_Treeview">
        <div class="show_btn" id="rightArrow"><span></span></div>
        <div class="widget-box side_content" >
         <div class="side_title"><a title="隐藏" class="close_btn"><span></span></a></div>
         <div class="side_list"><div class="widget-header header-color-green2"><h4 class="lighter smaller">泊位列表</h4></div>
         <div class="widget-body">
          <div class="widget-main padding-8">
		  <div id="treeDemo" class="ztree">
		  </div>
		  </div>
        </div>
       </div>
      </div>  
     </div>
   <div class="page_right_style">
   <div class="type_title">泊位信息录入</div>
	<form action="" method="post" class="form form-horizontal" id="form-article-add">
		<div class="clearfix cl">
         <label class="form-label col-2"><span class="c-red">*</span>泊位编号：</label>
		 <div class="formControls col-10" id="berthid"><input type="text" class="input-text" value="" placeholder="" id="input1"  name="" readonly></div>
		</div>
		<div class=" clearfix cl">
         <label class="form-label col-2">泊位类型：</label>
	     <div class="formControls col-10" id="berthingType"><input type="text" class="input-text" value="" placeholder="" id="input2" name="" readonly></div>
		</div>
		<div class=" clearfix cl">
			
			<div class="Add_p_s">
            <label class="form-label col-2">船舶编号：</label>
			<div class="formControls col-2"><input type="text" class="input-text" value="" placeholder="" id="input3" name=""></div>
            </div>
			<div class="Add_p_s">
             <label class="form-label col-2">靠泊时间：</label>	
			 <div class="formControls col-2"><input type="date"  value="" placeholder="" id="input4" name="" ></div>
			</div>
			
		</div>
		<div class=" clearfix cl">
			
			<div class="Add_p_s">
             <label class="form-label col-2">泊位状态：</label>	
			 <div class="formControls col-2">
			 
			 <span class="select-box">
				<select class="select" id="input5">
					<option value="启用中">启用中</option>
					<option value="已停用">已停用</option>
				</select>
				</span>
			 </div>
			</div>
            
			
            <div class="Add_p_s">
             <label class="form-label col-2">离港时间：</label>	
			 <div class="formControls col-2"><input type="date" value="" placeholder="" id="input6" name="" ></div>
			</div>
			
		</div>
		
		<div class="clearfix cl">
			<label class="form-label col-2">空闲状态：</label>
			<div class="formControls col-10" id="isLeisure">
				<input type="text" class="input-text" value="" placeholder="" id="input7" name="">
			</div>
		</div>
      
       
		<div class="clearfix cl">
			<div class="Button_operation">
				<button class="btn btn-primary radius" type="button" onclick="submitBerth()"  id="btn1"><i class="icon-save "></i>保存</button>
				<button onClick="layer_close();" class="btn btn-default radius" type="button">&nbsp;&nbsp;取消&nbsp;&nbsp;</button>
			</div>
		</div>
	</form>
    </div>
</div>
<script src="js/jquery-1.9.1.min.js"></script> 
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/typeahead-bs2.min.js"></script>
<script src="assets/layer/layer.js" type="text/javascript" ></script>
<script src="assets/laydate/laydate.js" type="text/javascript"></script>
<script type="text/javascript" src="Widget/My97DatePicker/WdatePicker.js"></script> 
<script type="text/javascript" src="Widget/icheck/jquery.icheck.min.js"></script> 
<script type="text/javascript" src="Widget/zTree/js/jquery.ztree.all-3.5.min.js"></script> 
<script type="text/javascript" src="Widget/Validform/5.3.2/Validform.min.js"></script> 
<script type="text/javascript" src="Widget/webuploader/0.1.5/webuploader.min.js"></script>
<script type="text/javascript" src="Widget/ueditor/1.4.3/ueditor.config.js"></script>
<script type="text/javascript" src="Widget/ueditor/1.4.3/ueditor.all.min.js"> </script>
<script type="text/javascript" src="Widget/ueditor/1.4.3/lang/zh-cn/zh-cn.js"></script> 
<script src="js/lrtk.js" type="text/javascript" ></script>
<script type="text/javascript" src="js/H-ui.js"></script> 
<script type="text/javascript" src="js/H-ui.admin.js"></script> 
<script>
$(function() { 
	$("#add_picture").fix({
		float : 'left',
		skin : 'green',	
		durationTime :false,
		stylewidth:'220',
		spacingw:0,
		spacingh:260,
	});
});
$( document).ready(function(){
//初始化宽度、高度
  
   $(".widget-box").height($(window).height()); 
   $(".page_right_style").height($(window).height()); 
   $(".page_right_style").width($(window).width()-220); 
  //当文档窗口发生改变时 触发  
    $(window).resize(function(){

	 $(".widget-box").height($(window).height()); 
	 $(".page_right_style").height($(window).height()); 
	 $(".page_right_style").width($(window).width()-220); 
	});	
});
$(function(){
	var ue = UE.getEditor('editor');
});
/******树状图********/
var setting = {
	view: {
		dblClickExpand: false,
		showLine: false,
		selectedMulti: false
	},
	data: {
		simpleData: {
			enable:true,
			idKey: "id",
			pIdKey: "pId",
			rootPId: ""
		}
	},
	callback: {
		beforeClick: function(treeId, treeNode) {
			var zTree = $.fn.zTree.getZTreeObj("tree");
			if (treeNode.isParent) {
				art.dialog({icon:'error', title:'友情提示', drag:false, resize:false, content:'只能选择泊位号', ok:true,});
				return false;
			} else {
				return true;
			}
		},
		onClick:onClick
	}
};

var zNodes =[
	{ id:1, pId:0, name:"泊位", open:true},
	{ id:11, pId:1, name:"1号泊位"},
	{ id:12, pId:1, name:"2号泊位"},
	{ id:13, pId:1, name:"3号泊位"},
	{ id:14, pId:1, name:"4号泊位"}];

function onClick(e, treeId, treeNode) {
			var fyDhCode = (treeNode.name).substring(0,1);
			console.log(fyDhCode+"泊位id");			
			$('#berthid').html("");
			$("#berthid").append("<input type='text' class='input-text' value='"+fyDhCode+"' id='input1' readonly/>");
			$('#berthingType').html("");
			//$('#isLeisure').html("");
			 $.ajax({
                url:"http://www.ct.com/berthing/queryBerthType?berthingId="+fyDhCode,
                dataType:"json",
                type:"get",
                success:function(data){
				if(data.status=200){
				
				   $("#berthingType").append("<input type='text' class='input-text' value='"+data.data+"' id='input2' readonly>");
				}
                },
                error : function(){
                    alert("请求失败");
                }
            });
		/*	$.ajax({
                url:"http://www.ct.com/berthing/queryBerthLeisure?berthingId="+fyDhCode,
                dataType:"json",
                type:"get",
                success:function(data){
				if(data.status=200){			
				   $("#isLeisure").append("<input type='text' class='input-text' value='"+data.data+"' id='input7' readonly>");
				}else{
				  $("#isLeisure").append("<input type='text' class='input-text' value='"+data.data+"' id='input7' readonly>");
              
				}
                },
                error : function(){
                    alert("请求失败");
                }
            });*/
			
			
		}
		
var zTree;
$(document).ready(function(){
	var t = $("#treeDemo");
	t = $.fn.zTree.init(t, setting, zNodes);
	demoIframe = $("#testIframe");
	//demoIframe.bind("load", loadReady);
	zTree = $.fn.zTree.getZTreeObj("tree");
	//zTree.selectNode(zTree.getNodeByParam("id",'11'));
});	

function submitBerth(){
  var berthingId=$('#input1').val();
  var berthTypeId=$('#input2').val();
  var shipId=$('#input3').val();
  var isLeisure=$('#input5').val();
  var berthingTime=$('#input4').val();
  var leavingTime=$('#input6').val();
  var berthingState=$('#input7').val();
  console.log(berthTypeId+"***");
	$.ajax({
		url:"http://www.ct.com/berthing/berthInfoEntry",
		type:"POST",
		data:{
		"berthingId":berthingId,
		"berthTypeId":berthTypeId,
		"shipId":shipId,
		"isLeisure":isLeisure,
		"berthingTime":berthingTime,
		"leavingTime":leavingTime,
		"berthingState":berthingState
		},
		dataType:"json",
		success:function(result){
			//result是服务端返回的数据
			if(result.status==200){
			  alert("录入成功");
			   window.location.reload();
			}else{
			art.dialog({icon:'error', title:'提示框', drag:false, resize:false, content:'录入失败，请重新录入', ok:true,});
			}
		},
		error:function(){
			layer.alert('请求失败！',{
               title: '提示框',				
			   icon:1,		
			  });
		}
	});
}
</script>
<script type="text/javascript">



</script>
</body>
</html>